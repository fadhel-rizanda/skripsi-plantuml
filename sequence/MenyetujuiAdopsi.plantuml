@startuml
' === Styling ===
skinparam sequence {
    LifelineFooterStrategy none
    MessageAlign center
    ArrowThickness 1
    ParticipantPadding 20
    GroupBorderThickness 0.5
    GroupBackgroundColor #F9F9F9
}
hide footbox

' === Participants ===
actor "Penyedia Hewan" as Provider
participant "Adoption Page (Next.js FE)" as FE
participant "AdoptionController (Laravel BE)" as BE
database "Database (PostgreSQL)" as DB

' === Flow: Menyetujui Proses Adopsi ===
Provider -> FE: Buka halaman "Adoption Process"
activate FE
FE -> BE: Request daftar proses adopsi
deactivate FE
activate BE
BE -> DB: Ambil semua proses adopsi milik penyedia
activate DB
DB --> BE: Return list of adoption processes
deactivate DB
BE --> FE: 200 Ok (Daftar proses adopsi)
deactivate BE
activate FE
FE -> Provider: Tampilkan daftar proses adopsi
deactivate FE

Provider -> FE: Pilih salah satu proses adopsi
activate FE
FE -> BE: Minta detail proses adopsi
deactivate FE
activate BE
BE -> DB: Ambil detail proses adopsi berdasarkan ID
activate DB
DB --> BE: Return adoption detail
deactivate DB
BE --> FE: 200 Ok (Detail proses adopsi)
deactivate BE
activate FE
FE -> Provider: Tampilkan tahapan proses adopsi
deactivate FE

Provider -> FE: Klik checkbox "I confirm the handover is complete"
activate FE
FE -> BE: Kirim permintaan finalisasi proses adopsi
deactivate FE
activate BE
BE -> DB: Perbarui status proses adopsi menjadi "Ready for Admin Finalization"
deactivate BE
activate DB
alt Gagal memperbarui status
    DB --> BE: Error (e.g., constraint violation / data not found / connection failure)
    activate BE
    BE --> FE: 500 Internal Server Error("Failed to update adoption status")
    deactivate BE
    activate FE
    FE -> Provider: Tampilkan pesan "Failed to update adoption status"
    deactivate FE
else Berhasil memperbarui status
    DB --> BE: Ok (Status updated)
    deactivate DB
    activate BE
    BE --> FE: 200 Ok ("Adoption approved")
    deactivate BE
    activate FE
    FE -> Provider: Tampilkan status baru "Ready for Admin Finalization"
    deactivate FE
end

@enduml
