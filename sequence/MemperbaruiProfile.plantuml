@startuml
' === Styling ===
skinparam sequence {
    LifelineFooterStrategy none
    MessageAlign center
    ArrowThickness 1
    ParticipantPadding 20
    GroupBorderThickness 0.5
    GroupBackgroundColor #F9F9F9
}
hide footbox

' === Participants ===
actor Pengguna
participant "Profile Page (Next.js FE)" as FE
participant "UserController (Laravel BE)" as BE
database "Database (PostgreSQL)" as DB


' === Flow 1: Membuka Halaman Profile ===
Pengguna -> FE: Buka halaman Detail Profile
activate FE
FE -> BE: GET /api/profile/{user_id}
deactivate FE
activate BE
BE -> DB: Ambil data profil berdasarkan user_id
deactivate BE
activate DB
alt Data profil ditemukan
DB --> BE: Return data profil
activate BE
    BE --> FE: 200 OK (Profile data)
    deactivate BE
    activate FE
    FE -> Pengguna: Tampilkan data profil dan tombol "Edit" jika user_id cocok
    deactivate FE
else Profil tidak ditemukan
DB --> BE: Error (e.g., data not found / connection failure)

deactivate DB
    activate BE
    BE --> FE: 404 Not Found ("Profile not found")
    deactivate BE
    activate FE
    FE -> Pengguna: Tampilkan pesan "Profile not found"
    deactivate FE
end


' === Flow 2: Mengedit dan Menyimpan Profil ===
Pengguna -> FE: Klik tombol "Edit"
activate FE
FE -> Pengguna: Form profil menjadi editable
deactivate FE

Pengguna -> FE: Ubah data dan klik "Save & Continue"
activate FE
FE -> BE: PUT /api/profile/{user_id} {data profil baru}
deactivate FE
activate BE
    BE -> DB: Update data profil user
    deactivate BE
    activate DB

    alt Update berhasil
        DB --> BE: Success (Profile updated)
    activate BE
        BE --> FE: 200 OK ("Profile updated successfully")
        deactivate BE
        activate FE
        FE -> Pengguna: Tampilkan pesan "Profile updated successfully"
        deactivate FE

    else Gagal memperbarui profil (DB error)
        DB --> BE: Error (e.g., constraint violation / data not found / connection failure)
        deactivate DB
        activate BE
        BE --> FE: 500 Internal Server Error ("Failed to update profile")
        deactivate BE
        activate FE
        FE -> Pengguna: Tampilkan pesan "Failed to update profile. Please try again."
        deactivate FE
    end

@enduml