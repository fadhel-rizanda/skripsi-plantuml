@startuml
' === Styling ===
skinparam sequence {
    LifelineFooterStrategy none
    MessageAlign center
    ArrowThickness 1
    ParticipantPadding 20
    GroupBorderThickness 0.5
    GroupBackgroundColor #F9F9F9
}
hide footbox


' === Participants ===
actor Pengguna
participant "Notification Page (Next.js FE)" as FE
participant "NotificationController (Larvel BE)" as BE
database "Database (PostgreSQL)" as DB


' === Normal Flow: Melihat Daftar Notifikasi ===
Pengguna -> FE: Klik ikon lonceng pada navbar
activate FE
FE -> BE: GET /api/notifications
deactivate FE
activate BE
BE -> DB: Ambil daftar notifikasi berdasarkan user_id
activate DB
DB --> BE: Return list of notifications / null
deactivate DB

alt Tidak ada notifikasi baru
    BE --> FE: 200 OK (Empty list)
    deactivate BE
    activate FE
    FE -> Pengguna: Tampilkan pesan "No new notifications"
    deactivate FE
else Notifikasi tersedia
    BE --> FE: 200 OK (List of notifications)
    activate FE
    FE -> Pengguna: Tampilkan drawer berisi daftar notifikasi
    deactivate FE
' === Subflow S-1: Membuka Notifikasi ===
Pengguna -> FE: Klik salah satu notifikasi dari daftar
activate FE
FE -> BE: PUT /api/notifications/{notification_id}/read
deactivate FE
activate BE
BE -> DB: Update notifikasi dengan is_read = true
activate DB
alt Berhasil update
    DB --> BE: OK (updated)
    BE --> FE: 200 OK ("Notification marked as read")
    deactivate BE
    activate FE
    FE -> Pengguna: Tandai notifikasi sebagai terbaca dan arahkan ke halaman terkait
    deactivate FE
else Gagal update notifikasi
    DB --> BE: Error (Update failed / DB unreachable)
    deactivate DB
    activate BE
    BE --> FE: 500 Internal Server Error ("Failed to update notification status")
    deactivate BE
    activate FE
    FE -> Pengguna: Tampilkan pesan error "Gagal menandai notifikasi sebagai terbaca"
    deactivate FE
end
end


@enduml
